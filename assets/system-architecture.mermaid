graph LR
    subgraph User Interaction [User Interaction]
        A[User Application/Client] --> B(API Endpoint)
    end

    %% --- Blank Line and Comment to Separate Subgraph ---
    

    B -.-> C  
    %% Dashed line to visually separate sections

    subgraph Request Handling [Request Handling]
        C{Request Queue} --> D{Batching Engine}
        D --> E{Input Preprocessing}
    end

    %% --- Blank Line and Comment to Separate Subgraph ---
    

    E -.-> F 
    %% Dashed line to visually separate sections

    subgraph Core Engine [Core Engine]
        F{Graph Compiler} --> G{Execution Engine}
        G --> H{Hardware Abstraction Layer - HAL }
    end

    %% --- Blank Line and Comment to Separate Subgraph ---
    

    H -.-> I 
    %% Dashed line to visually separate sections

    subgraph Hardware Backends [Hardware Backends]
        H --> I[NVIDIA GPU - CUDA]
        H --> J[AMD GPU - ROCm]
        H --> K[Apple GPU - Metal]
        H --> L[Intel GPU - oneAPI]
        H --> M[CPU - oneDNN/MKL]
    end

    %% --- Blank Line and Comment to Separate Subgraph ---
    

    M -.-> N 
    %% Dashed line to visually separate sections

    subgraph Output Processing [Output Processing]
        G --> N{Output Postprocessing}
        N --> O(API Response)
    end
    O --> A

    style B fill:#f9f,stroke:#333,stroke-width:2px
    style D fill:#ccf,stroke:#333,stroke-width:2px
    style F fill:#cff,stroke:#333,stroke-width:2px
    style G fill:#cfc,stroke:#333,stroke-width:2px
    style H fill:#fcc,stroke:#333,stroke-width:2px

    classDef componentFill fill:#eee,stroke:#333,stroke-width:1px
    class B,D,F,G,H,C,E,N componentFill